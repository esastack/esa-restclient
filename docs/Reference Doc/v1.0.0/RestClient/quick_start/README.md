三.测试结果&结果分析1. **ESA-HttpClient性能测试**前置条件：基本echo测试，POST请求，返回固定string： OK**异步与同步请求比例****业务线程数****io线程池大小****TPS****RT****成功率****失败个数****maxrt****minrt****50rt****90rt****95rt****99rt****client cpu \* load**-1(仅同步)146750.40.15100%01670011185.4%101442257.690.19100%018000111214.7%501474999.070.43100%019100111305.6%1001485263.010.69100%018601112320.6%30014101888.381.51100%022901234355.2%50014110005.132.01100%025502446373.3%80014116013.752.72100%0329047710368.5%100014100005.135.14100%0388058912390.0%-1(仅同步)104192760.51100%018600111390.8%1010472463.81.29100%019101223391.0%50104105956.24.41100%0252046710391.3%100104106195.08.84100%275437508121318390.0%300104Too many outstanding acquire operations 结果分析：ESA-HttpClient 随着 **异步与同步请求比例** 增大而增大，在业务线程为单线程时，比例为800时，TPS最佳，为116013.75. **2 ESA-RestClient性能测试**前置条件：基本echo测试，POST请求，返回固定string： OK**异步与同步请求比例****业务线程数****io线程池大小****TPS****RT****成功率****失败个数****maxrt****minrt****50rt****90rt****95rt****99rt****client cpu \* load**-1(仅同步)146727.320.15100%01640011196.0%101440252.370.2100%018600111217.3%501472447.110.43100%019000111291.0%1001487201.450.64100%018201112326.7%30014104129.041.38100%025801234370.1%50014107217.982.18100%024102446376.7%80014111217.982.88100%0261037811373.4%10001499656.494.59100%0376048913386.4%-1(仅同步)10418756.150.53100%018300111393.4%1010476462.321.21100%020401225394.2%5010490323.845.16100%0309057811393.8%10010484505.2211.15100%0500011141623390.0%300104Too many outstanding acquire operations 结果分析：ESA-RestClient 随着 **异步与同步请求比例** 增大而增大，在业务线程为单线程时，比例为800时，TPS最佳，为111217.98. 3 Apache-HttpAsyncClient前置条件：基本echo测试，POST请求，返回固定string： OK**异步与同步请求比例****业务线程数****io线程池大小****TPS****RT****成功率****失败个数****maxrt****minrt****50rt****90rt****95rt****99rt****client cpu \* load**-1(仅同步)148257.910.12100%0880011191.0%1001468515.90.21100%09000112389.7%5001471101.490.37100%08900112393.1%8001483962.540.55100%09200112391.0%10001478786.090.78100%010800124394.3%20001465447.157.8499.4%358112608141520384.3%-1(仅同步)10418923.590.53100%08100111400.0%5010489633.734.53100%0246034829400.0%10010488803.959.1199.6%872120107133035400.0%300104大量 ConnectTimeout 结果分析：Apache-HttpAsyncClient 随着 **异步与同步请求比例** 增大而增大，在业务线程为10线程时，比例为50时，TPS最佳，为 89633.73. 4.OK-HttpClient**异步与同步请求比例****MaxRequestsPerHost****TPS****RT****成功率****失败个数****maxrt****minrt****50rt****90rt****95rt****99rt****client cpu \* load**-1(仅同步)110063.360.10100%08200011106.3%-1(仅同步)1010184.360.10100%05500011112.0%501060600.310.42100%06900111400.0%502047922.050.50100%07200111400.0%1001065527.590.73100%06700111400.0%1002054150.840.83100%080023317400.0%3001070501.591.93100%07300111400.0%3002059713.642.17100%0102012253400.0%5001069633.593.2100%0101035522400.0%5002060709.263.52100%0105013456400.0%结果分析：OK-HttpClient 在**异步与同步请求比例**为300 时，**MaxRequestsPerHost** 为10 时，TPS最佳，为 70501.59. 四.测试结论 综上：     **ESA-HttpClient 与 ESA-RestClient 随着 异步与同步请求比例 增大而增大，在业务线程为单线程时，比例为800时，TPS最佳，其中ESA-HttpClient为 116013.75，ESA-RestClient 为 111217.98。ESA-RestClient的包裹在ESA-HttpClient的外部逻辑没有消耗过多的性能，符合预期。**         **HttpClient的最佳TPS 较 Apache-HttpAsyncClient 高 29%，较OK-HttpClient高 66% 。**